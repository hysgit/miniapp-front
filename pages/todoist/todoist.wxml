<view class="container">
  <view class="tab-container">
    <view class="tab-item {{activeTab === 'todo' ? 'active' : ''}}" bindtap="switchTab" data-tab="todo">
      未完成
    </view>
    <view class="tab-item {{activeTab === 'done' ? 'active' : ''}}" bindtap="switchTab" data-tab="done">
      已完成
    </view>
  </view>

  <view class="content">
    <view wx:if="{{activeTab === 'todo'}}" class="todo-list">
      <block wx:if="{{todoList.length > 0}}">
        <movable-area class="todo-item-wrapper" wx:for="{{todoList}}" wx:key="id">
          <movable-view class="todo-item-content" direction="horizontal" out-of-bounds="true" x="{{item.x}}" damping="50" bindchange="handleMovableChange" bindtouchend="handleTouchEnd" data-id="{{item.id}}">
            <view class="todo-item">
              <view class="checkbox" catchtap="toggleTodoStatus" data-id="{{item.id}}">
                <view class="checkbox-inner"></view>
              </view>
              <view class="todo-info" bindtap="editTodoItem" data-id="{{item.id}}">
                <view class="title-row">
                  <text class="todo-title">{{item.title}}</text>
                  <text class="priority-tag priority-{{item.priority}}">
                    {{item.priority === 0 ? '普通' : '重要'}}
                  </text>
                </view>
                <text class="todo-description" wx:if="{{item.description}}">{{item.description}}</text>
                <text class="due-date" wx:if="{{item.dueDate}}">截止日期：{{item.dueDate}}</text>
              </view>
            </view>
          </movable-view>
          <view class="delete-btn" bindtap="deleteTodoItem" data-id="{{item.id}}">删除</view>
        </movable-area>
      </block>
      <view wx:else class="empty-state">
        <text class="empty-text">暂无待办事项</text>
      </view>
    </view>

    <view wx:if="{{activeTab === 'done'}}" class="done-list">
      <block wx:if="{{doneList.length > 0}}">
        <movable-area class="todo-item-wrapper" wx:for="{{doneList}}" wx:key="id">
          <movable-view class="todo-item-content" direction="horizontal" out-of-bounds="true" x="{{item.x}}" damping="50" bindchange="handleMovableChange" bindtouchend="handleTouchEnd" data-id="{{item.id}}">
            <view class="todo-item done">
              <view class="checkbox checked" catchtap="toggleTodoStatus" data-id="{{item.id}}">
                <view class="checkbox-inner"></view>
              </view>
              <view class="todo-info">
                <view class="title-row">
                  <text class="todo-title">{{item.title}}</text>
                  <text class="priority-tag priority-{{item.priority}}">
                    {{item.priority === 0 ? '普通' : '重要'}}
                  </text>
                </view>
                <text class="todo-description" wx:if="{{item.description}}">{{item.description}}</text>
                <text class="due-date" wx:if="{{item.dueDate}}">截止日期：{{item.dueDate}}</text>
                <text class="complete-time" wx:if="{{item.completedTime}}">完成时间：{{item.completedTime}}</text>
              </view>
            </view>
          </movable-view>
          <view class="delete-btn" bindtap="deleteTodoItem" data-id="{{item.id}}">删除</view>
        </movable-area>
      </block>
      <view wx:else class="empty-state">
        <text class="empty-text">暂无已完成事项</text>
      </view>
    </view>
  </view>

  <view class="add-btn" bindtap="showAddTodoModal">+</view>
</view>